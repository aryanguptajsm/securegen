<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SecureGen — Smart & Strong Security Tools</title>
  <meta name="description" content="SecureGen — Free premium password generator, username ideas, strength checker. No signup, local-only storage, works offline."/>
  <meta name="theme-color" content="#ffffff"/>
  <link rel="icon" href="data:,"> 
    <style>
    :root{
      /* Light theme (default) variables */
      --royal-blue: #0066ff;
      --white: #ffffff;
      --text: #0b1220;
      --muted: #6b7280;
      --card-bg: rgba(255,255,255,0.85);
      --panel-bg: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(248,250,255,0.9));
      --result-bg: #0f172a;
      --bg: linear-gradient(180deg, rgba(0,102,255,0.12) 0%, rgba(255,255,255,1) 55%, #fbfdff 100%);
      --danger: #ef4444;
      --success: #16a34a;
      --radius: 8px;
      --shadow: 0 10px 30px rgba(2,6,23,0.08);
      font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;padding:0;width:100%;}
    body{
      min-height:100vh;
      margin:0;
      background: var(--bg);
      color: var(--text);
      -webkit-font-smoothing:antialiased;
      background-repeat:no-repeat;
      background-attachment:fixed;
      transition: background 350ms ease, color 250ms ease;
      font-size:16px;
    }

    header{position:sticky;top:12px;z-index:120;padding:8px 0;width:100%;}
    .nav-wrap{
      backdrop-filter: blur(8px) saturate(1.05);
      -webkit-backdrop-filter: blur(8px);
      background: rgba(255,255,255,0.72);
      border-radius:12px;
      padding:8px 12px;
      box-shadow:var(--shadow);
      border:1px solid rgba(0,102,255,0.06);
      width:100%;
    }
    .container{max-width:1100px;margin:0 auto;padding:10px 22px;width:100%;}
    .nav{display:flex;align-items:center;gap:18px;flex-wrap:wrap;}
    .logo{font-weight:800;font-size:20px;letter-spacing:0.3px;color:var(--royal-blue);display:flex;align-items:center;gap:10px}
    nav ul{list-style:none;margin:0;padding:0;display:flex;gap:14px;align-items:center;flex-wrap:wrap;}
    nav a{color:var(--royal-blue);text-decoration:none;font-weight:700}

    .hero{
      display: grid;
      grid-template-columns:1fr 420px;
      gap:28px;
      align-items:center;
      padding:36px 0;
    }
    .panel{
      background:var(--panel-bg);
      padding:18px;
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      border:1px solid rgba(255,255,255,0.6)
    }
    .cards{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:14px;
      margin-top:18px;
    }
    .card{padding:18px;border-radius:var(--radius);box-shadow:0 6px 18px rgba(2,6,23,0.06);border:1px solid rgba(255,255,255,0.6);background:linear-gradient(180deg, rgba(255,255,255,0.95), #fbfdff)}
    .btn{background:var(--royal-blue);color:var(--white);border:none;padding:12px 18px;border-radius:10px;font-weight:800;cursor:pointer}
    .btn.secondary{background:transparent;color:var(--royal-blue);border:1px solid rgba(0,81,255,0.12)}
    .tools{
      display:grid;
      grid-template-columns:1fr 360px;
      gap:18px;
      width:100%;
    }
    .checkboxes{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .strength{height:12px;background:#eef2ff;border-radius:999px;overflow:hidden;border:1px solid rgba(2,6,23,0.03)}
    .strength > i{display:block;height:100%;width:0%;background:linear-gradient(90deg,var(--danger),#ffc107,var(--success));transition:width .35s}
    .result{
      font-family:ui-monospace,monospace;
      background:var(--result-bg);
      color:#fff;
      padding:12px;
      border-radius:8px;
      margin-top:12px;
      overflow-x:auto;
      word-break:break-all;
      max-width:100%;
    }
    .saved-list{max-height:320px;overflow:auto}
    .saved-item{display:flex;align-items:center;justify-content:space-between;padding:10px;border-radius:8px;background:linear-gradient(180deg,rgba(255,255,255,0.55),#fbfdff);border:1px solid rgba(255,255,255,0.5);margin-bottom:6px;}
    .suggestion{padding:10px;border-radius:8px;background:linear-gradient(180deg,#ffffff,#fbfdff);border:1px solid rgba(0,81,255,0.06);display:flex;justify-content:space-between;align-items:center;margin-bottom:7px;}
    .badge{padding:6px 10px;border-radius:10px;background:linear-gradient(90deg,#eef2ff,#f7f9ff);font-weight:800;color:var(--royal-blue)}
    .test-output{font-family:ui-monospace,monospace;font-size:12px;color:#6b7280;display:none}

    /* Hide scrollbars for container on mobile horizontally */
    .container, .panel, .tools, .hero, .cards {overflow-x:auto;}

    /* Dark theme overrides */
    body.dark{
      --royal-blue: #4d84ff;
      --text: #e6eefb;
      --muted: #94a3b8;
      --card-bg: rgba(8,12,18,0.8);
      --panel-bg: linear-gradient(180deg, rgba(18,20,24,0.9), rgba(34,36,40,0.9));
      --result-bg: linear-gradient(180deg,#0b0f13,#1f2328);
      --bg: linear-gradient(180deg, #0b0f13 0%, #202428 100%);
      color: var(--text);
    }
    body.dark .nav-wrap{
      background: rgba(6,10,20,0.6);
      border:1px solid rgba(255,255,255,0.04);
    }
    body.dark .logo, body.dark nav a{ color: var(--royal-blue) }
    body.dark .panel, body.dark .card{
      background:var(--panel-bg);
      color: var(--text);
      border:1px solid rgba(255,255,255,0.04);
      box-shadow: 0 8px 24px rgba(2,6,23,0.35);
    }
    body.dark .btn{ background:var(--royal-blue); color:var(--white) }
    body.dark .btn.secondary{ background:transparent; color:var(--royal-blue); border:1px solid rgba(255,255,255,0.04) }
    body.dark .result{ background:var(--result-bg); color:var(--text) }
    body.dark input, body.dark textarea, body.dark select, body.dark .checkboxes input[type="checkbox"]{
      background:#071424;
      color:var(--text);
      border:1px solid rgba(255,255,255,0.04);
    }
    body.dark .strength{ background:#0b1220; border:1px solid rgba(255,255,255,0.04) }
    body.dark .badge{ background: linear-gradient(90deg,#214de6,#4db3ff); color:#fff }

    /* RESPONSIVE DESIGN - start here */
    @media (max-width: 1200px){
      .container{max-width:98vw;padding:8px;}
      .tools{grid-template-columns:1fr 300px;}
      .hero{grid-template-columns:1fr 340px;}
    }
    @media (max-width: 900px){
      .tools, .hero{
        grid-template-columns:1fr;
        gap:16px;
      }
      aside{
        margin-top:18px;
        width:100%;
      }
    }
    @media (max-width: 660px) {
      html, body{font-size:15px;}
      .container{padding:7px;}
      header{top:8px;}
      .panel{padding:12px;}
      nav ul{gap:7px;}
      .card{padding:12px;}
    }
    @media (max-width: 600px) {
      html, body{font-size:14.5px;}
      .container{padding:3px;}
      .panel, .card{padding:8px;}
      .cards{grid-template-columns:1fr;}
      nav ul{gap:5px;}
      .result, pre{font-size:13px;padding:8px;}
      .btn, .btn.secondary{padding:9px 12px;font-size:15px;}
      .hero,.tools{padding:0;}
    }
    @media (max-width:430px) {
      html, body{font-size:13.2px;}
      .container{padding:1px;}
      .panel, .card{padding:4px;}
    }
    /* For narrow screens, stack everything and use full width panels */
    @media (max-width: 900px) {
      .panel, .card, aside, .tools, .hero, .container{max-width:100vw;}
    }
    /* Make sure pre and result containers always fit the screen and wrap */
    pre, .result {white-space:pre-wrap;word-break:break-all;max-width:100vw;}
  </style>
</head>
<body>
  <header>
    <div class="container nav-wrap">
      <div class="nav">
        <div class="logo"><svg viewBox="0 0 24 24" width="28" height="28" style="opacity:.9"><path d="M12 2l7 3v5c0 5-3 9-7 12-4-3-7-7-7-12V5l7-3z" fill="currentColor" opacity="0.12"></path><path d="M9 11a3 3 0 106 0 3 3 0 00-6 0z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"></path></svg><span>SecureGen</span></div>
        <nav style="margin-left:14px">
          <ul>
            <li><a href="#home" class="nav-link">Home</a></li>
            <li><a href="#tools" class="nav-link">Tools</a></li>
            <li><a href="#about" class="nav-link">About</a></li>
            <li><a href="#contact" class="nav-link">Contact</a></li>
            <li><a href="#privacy" class="nav-link">Privacy</a></li>
          </ul>
        </nav>
        <div style="margin-left:auto;display:flex;align-items:center;gap:10px"><label style="display:flex;align-items:center;gap:8px"><input id="themeToggle" type="checkbox" aria-label="Toggle dark mode"><span style="font-size:13px;color:#94a3b8">Dark</span></label></div>
      </div>
    </div>
  </header>

  <main class="container">
    <section id="home" class="hero">
      <div class="panel">
        <h1 style="margin:0 0 8px">Protect Your Digital Life with Smart Security Tools</h1>
        <p style="margin:0 0 12px;color:#6b7280">Generate secure passwords instantly, test strength, and save locally — no signup, no tracking.</p>
        <div style="display:flex;gap:10px;margin-bottom:16px"><button class="btn" id="jump-generator">Generate Password</button><button class="btn secondary" id="try-tools">Try All Tools</button></div>
        <div class="cards">
          <div class="card"><strong>Password Generator</strong><p style="margin:6px 0;color:#6b7280">Create long, random, secure passwords with one click.</p></div>
          <div class="card"><strong>Password Strength Checker</strong><p style="margin:6px 0;color:#6b7280">Analyze a password and get actionable improvements.</p></div>
          <div class="card"><strong>Username Ideas</strong><p style="margin:6px 0;color:#6b7280">Get creative usernames for games, socials, or pro profiles.</p></div>
          <div class="card"><strong>Local Save</strong><p style="margin:6px 0;color:#6b7280">Saved on your device only — we don't store your secrets.</p></div>
        </div>
      </div>

      <div class="panel">
        <h3 style="margin:0 0 6px">Quick Password — Premium UI</h3>
        <p style="margin:0 0 10px;color:#6b7280">Try a fast generator without leaving the home screen.</p>
        <label for="quickLength">Length</label>
        <input id="quickLength" type="range" min="6" max="30" value="16">
        <div style="display:flex;gap:8px;margin:10px 0"><button class="btn" id="quickGen">Generate</button><button class="btn secondary" id="quickCopy">Copy</button></div>
        <pre id="quickResult" class="result" style="margin-top:8px">-- generated password --</pre>
        <div style="margin-top:8px;color:#6b7280;font-size:13px">Ad placeholder — Add Google AdSense / Affiliate Banner Here</div>
      </div>
    </section>

    <section id="tools" style="margin-top:18px">
      <div class="tools">
        <div>
          <div id="generator" class="panel">
            <h2>Password Generator</h2>
            <p style="color:#6b7280;margin:6px 0">Choose options and click generate. Save locally if you want to keep it for later.</p>
            <label>Length <span id="lengthVal" style="margin-left:8px;color:#6b7280">16</span></label>
            <input id="length" type="range" min="6" max="30" value="16">
            <div class="checkboxes" style="margin-top:10px">
              <label><input type="checkbox" id="upper" checked> Uppercase</label>
              <label><input type="checkbox" id="lower" checked> Lowercase</label>
              <label><input type="checkbox" id="numbers" checked> Numbers</label>
              <label><input type="checkbox" id="symbols" checked> Symbols</label>
            </div>
            <div style="display:flex;gap:8px;margin-top:12px"><button class="btn" id="generate">Generate Password</button><button class="btn secondary" id="copy">Copy</button><button class="btn secondary" id="save">Save Locally</button></div>
            <pre id="result" class="tools result">-- your password will appear here --</pre>
            <label style="display:block;margin-top:10px">Strength</label>
            <div class="strength"><i id="strengthBar"></i></div>
            <div id="strengthText" style="margin-top:8px;color:#6b7280">No password</div>

            <div style="margin-top:14px">
              <label>Smart Suggestions</label>
              <div style="display:flex;gap:8px;margin-top:8px">
                <select id="suggestCategory" style="padding:8px;border-radius:6px">
                  <option value="super">Super Secure</option>
                  <option value="gamer">Gamer</option>
                  <option value="stylish">Stylish</option>
                  <option value="minimal">Minimal</option>
                </select>
                <button class="btn" id="genSuggest">Generate Suggestions</button>
              </div>
              <div id="suggestions" style="margin-top:10px"></div>
            </div>
          </div>

          <div id="usernameGen" class="panel" style="margin-top:12px">
            <h3>Username Ideas</h3>
            <p style="color:#6b7280;margin:6px 0">Choose a style and generate multiple suggestions.</p>
            <label for="unameStyle">Style</label>
            <select id="unameStyle" style="padding:8px;border-radius:6px">
              <option value="cool">Cool</option>
              <option value="gamer">Gamer</option>
              <option value="pro">Professional</option>
              <option value="random">Random</option>
            </select>
            <div style="display:flex;gap:8px;margin-top:10px"><button class="btn" id="genUser">Generate Usernames</button></div>
            <div id="userList" style="margin-top:12px"></div>
          </div>

          <div id="strengthChecker" class="panel" style="margin-top:12px">
            <h3>Password Strength Checker</h3>
            <p style="color:#6b7280;margin:6px 0">Paste a password to analyze entropy and get tips.</p>
            <input id="checkInput" type="text" placeholder="Paste password to analyze" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(0,0,0,0.06)">
            <div style="display:flex;gap:8px;margin-top:8px"><button class="btn" id="checkBtn">Check Strength</button><button class="btn secondary" id="clearCheck">Clear</button></div>
            <div id="checkResult" style="margin-top:10px;color:#6b7280;font-size:13px">No password checked yet.</div>
          </div>
        </div>

        <aside>
          <div class="panel">
            <h3>Saved Passwords (Local Only)</h3>
            <p style="color:#6b7280;margin:6px 0">Only on your device. You can export or clear anytime.</p>
            <div class="saved-list" id="savedList"><div style="color:#6b7280">No saved passwords yet.</div></div>
            <div style="display:flex;gap:8px;margin-top:10px"><button class="btn secondary" id="exportBtn">Export (Copy JSON)</button><button class="btn secondary" id="clearAll">Clear All</button></div>
          </div>

          <div class="panel" style="margin-top:12px">
            <h4>Security Tip</h4>
            <p style="color:#6b7280;margin:6px 0">Don’t reuse passwords across important accounts. Use a password manager for storage.</p>
            <div style="margin-top:12px;color:#6b7280">Affiliate / Ad spot</div>
          </div>
        </aside>
      </div>
    </section>

    <section id="about" style="margin-top:18px"><div class="panel"><h2>About SecureGen</h2><p style="color:#6b7280">SecureGen is a free set of tools to help users create and test strong passwords and generate username ideas. We prioritize privacy — no login required, no data sent to servers. All saved passwords remain on your device unless you export them.</p></div></section>

    <section id="contact" style="margin-top:18px"><div class="panel"><h2>Contact</h2><p style="color:#6b7280">Have feedback or suggestions? Reach out.</p><label for="name">Name</label><input id="name" type="text" style="width:100%;padding:8px;border-radius:6px"><label for="email" style="margin-top:8px;display:block">Email</label><input id="email" type="text" style="width:100%;padding:8px;border-radius:6px"><label style="margin-top:8px;display:block">Message</label><textarea id="message" style="width:100%;height:120px;padding:8px;border-radius:6px"></textarea><div style="display:flex;gap:8px;margin-top:8px"><button class="btn" id="sendMsg">Send Message</button></div></div></section>

    <section id="privacy" style="margin-top:18px"><div class="panel"><h2>Privacy Policy</h2><p style="color:#6b7280">SecureGen does not collect or store your passwords on our servers. All saved data is kept in your browser's local storage. We use no cookies for tracking.</p></div></section>

    <section id="terms" style="margin-top:18px;margin-bottom:28px"><div class="panel"><h2>Terms & Conditions</h2><p style="color:#6b7280">Use these tools at your own risk.</p></div></section>

    <footer style="margin-bottom:32px"><div class="container"><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:18px"><div><strong>SecureGen</strong><p style="color:#6b7280">Smart & Strong Security Tools for Everyone</p></div><div><h4>Product</h4><p><a href="#tools">Tools</a></p></div><div><h4>Company</h4><p><a href="#about">About</a></p></div><div><h4>Contact</h4><p style="color:#6b7280">Email: aryangupta.jsm@gmail.com</p></div></div></div></footer>
  </main>

  <div id="testOutput" class="test-output" aria-hidden="true"></div>

  <script>
    // Wrap all DOM access in DOMContentLoaded to avoid issues where elements are not present yet
    document.addEventListener('DOMContentLoaded', ()=>{
      // Basic nav
      document.querySelectorAll('a.nav-link').forEach(a=>{a.addEventListener('click',e=>{e.preventDefault();const t=a.getAttribute('href').slice(1);location.hash=t;document.getElementById(t)?.scrollIntoView({behavior:'smooth',block:'start'})})});

      // Theme toggle
      const themeToggle = document.getElementById('themeToggle');
      const metaTheme = document.querySelector('meta[name="theme-color"]');
      const savedTheme = localStorage.getItem('sg_theme');

      function applyTheme(t){
        if(t === 'dark'){
          document.body.classList.add('dark');
          if(themeToggle) themeToggle.checked = true;
          if(metaTheme) metaTheme.setAttribute('content','#0b0f13');
        }else{
          document.body.classList.remove('dark');
          if(themeToggle) themeToggle.checked = false;
          if(metaTheme) metaTheme.setAttribute('content','#ffffff');
        }
      }

      // Apply saved theme (default is light)
      applyTheme(savedTheme === 'dark' ? 'dark' : 'light');

      if(themeToggle){
        themeToggle.addEventListener('change',()=>{
          const newTheme = themeToggle.checked ? 'dark' : 'light';
          applyTheme(newTheme);
          localStorage.setItem('sg_theme', newTheme);
        });
      }

      // Utilities
      function copyToClipboard(text){ if(!text) return alert('Nothing to copy'); if(navigator.clipboard){navigator.clipboard.writeText(text).then(()=>alert('Copied to clipboard')).catch(()=>fallbackCopy(text))}else{fallbackCopy(text)} }
      function fallbackCopy(text){const ta=document.createElement('textarea');ta.value=text;document.body.appendChild(ta);ta.select();document.execCommand('copy');ta.remove();alert('Copied (fallback)') }

      // Password generation helpers
      function pick(arr){return arr[Math.floor(Math.random()*arr.length)]}
      function randomDigits(n){let s='';for(let i=0;i<n;i++)s+=Math.floor(Math.random()*10);return s}
      function generatePasswordCustom(len,upper,lower,numbers,symbols){
        const U='ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        const L='abcdefghijklmnopqrstuvwxyz';
        const N='0123456789';
        const S='!@#$%^&*()-_=+[]{};:,.<>?/~`';
        let pool='';
        if(upper)pool+=U;
        if(lower)pool+=L;
        if(numbers)pool+=N;
        if(symbols)pool+=S;
        if(!pool) return '';
        let pwd='';
        const types=[];
        if(upper)types.push(U);
        if(lower)types.push(L);
        if(numbers)types.push(N);
        if(symbols)types.push(S);
        // Ensure each selected type is represented at least once
        for(let i=0;i<types.length;i++){
          const set = types[i];
          pwd += set[Math.floor(Math.random()*set.length)];
        }
        for(let i=pwd.length;i<len;i++) pwd += pool[Math.floor(Math.random()*pool.length)];
        // Shuffle
        pwd = pwd.split('').sort(()=>Math.random()-0.5).join('');
        return pwd;
      }
      function generatePassword(len,opts){
        if(typeof opts==='string'){
          if(opts==='super') return generatePasswordCustom(len,true,true,true,true);
          if(opts==='gamer') return smartSuggestions('gamer',1)[0].pwd;
          if(opts==='stylish') return smartSuggestions('stylish',1)[0].pwd;
          if(opts==='minimal') return smartSuggestions('minimal',1)[0].pwd;
        }
        const {upper,lower,numbers,symbols} = opts || {upper:true,lower:true,numbers:true,symbols:true};
        return generatePasswordCustom(len,upper,lower,numbers,symbols);
      }

      // Smart suggestions
      function smartSuggestions(category,count){
        const out=[];
        for(let i=0;i<count;i++){
          if(category==='super'){
            const len=20+Math.floor(Math.random()*11);
            out.push({pwd:generatePasswordCustom(len,true,true,true,true),meta:'Super secure — long mixed characters'});
          }else if(category==='gamer'){
            const base=pick(['Nova','Echo','Apex','Vortex','Neon','Zenith','Orion']);
            const suffix=randomDigits(2)+pick(['','_x','_pro','_yt']);
            const add=pick(['!','@','#','$']);
            const pwd=base+suffix+add;
            out.push({pwd,meta:'Gamer style — memorable + symbols'});
          }else if(category==='stylish'){
            const len=12+Math.floor(Math.random()*6);
            let p=generatePasswordCustom(len,true,true,true,true);
            const mid=Math.floor(p.length/2);
            const pretty=p.slice(0,mid)+'-'+p.slice(mid);
            out.push({pwd:pretty,meta:'Stylish — balanced security + look'});
          }else{
            const len=10+Math.floor(Math.random()*3);
            out.push({pwd:generatePasswordCustom(len,true,true,true,false),meta:'Minimal — easy to type, moderate security'});
          }
        }
        return out;
      }

      // Elements (check existence before using)
      const quickGen = document.getElementById('quickGen');
      const quickResult = document.getElementById('quickResult');
      const quickCopy = document.getElementById('quickCopy');
      const quickLength = document.getElementById('quickLength');
      const length = document.getElementById('length');
      const lengthVal = document.getElementById('lengthVal');
      const generateBtn = document.getElementById('generate');
      const copyBtn = document.getElementById('copy');
      const saveBtn = document.getElementById('save');
      const result = document.getElementById('result');
      const strengthBar = document.getElementById('strengthBar');
      const strengthText = document.getElementById('strengthText');
      const genSuggest = document.getElementById('genSuggest');
      const suggestCategory = document.getElementById('suggestCategory');
      const suggestionsEl = document.getElementById('suggestions');
      const genUser = document.getElementById('genUser');
      const userList = document.getElementById('userList');
      const checkBtn = document.getElementById('checkBtn');
      const checkInput = document.getElementById('checkInput');
      const checkResult = document.getElementById('checkResult');

      // Safe event binding helpers
      if(quickGen){
        quickGen.addEventListener('click', ()=>{
          const len = parseInt(quickLength?.value,10) || 16;
          const pwd = generatePassword(len,'super');
          if(quickResult) quickResult.textContent = pwd;
          // attach meta to quickResult panel (if present)
          renderSuggestionMeta(pwd, quickResult);
          // update global strength display
          updateStrength(pwd);
        });
      }
      if(quickCopy) quickCopy.addEventListener('click', ()=>copyToClipboard(quickResult?.textContent));

      if(length && lengthVal) length.addEventListener('input', ()=> lengthVal.textContent = length.value);
      if(generateBtn){
        generateBtn.addEventListener('click', ()=>{
          const opts = {upper:document.getElementById('upper').checked, lower:document.getElementById('lower').checked, numbers:document.getElementById('numbers').checked, symbols:document.getElementById('symbols').checked};
          const pwd = generatePassword(parseInt(length.value,10)||16, opts);
          if(result) result.textContent = pwd;
          updateStrength(pwd);
          renderSuggestionMeta(pwd, result);
        });
      }
      if(copyBtn) copyBtn.addEventListener('click', ()=>copyToClipboard(result?.textContent));
      if(saveBtn){
        saveBtn.addEventListener('click', ()=>{
          const name = prompt('Label for this password (e.g. Gmail, Bank) — saved locally only:');
          if(!name) return alert('Cancelled');
          savePassword(name, result?.textContent);
          renderSaved();
        });
      }

      if(genSuggest){
        genSuggest.addEventListener('click', ()=>{const cat=suggestCategory.value;const arr=smartSuggestions(cat,6);renderSuggestions(arr)});
      }

      function renderSuggestions(list){
        if(!suggestionsEl) return;
        suggestionsEl.innerHTML='';
        list.forEach(item=>{
          const wrap=document.createElement('div');wrap.className='suggestion';
          const left=document.createElement('div');
          const title=document.createElement('div');title.style.fontFamily='ui-monospace,monospace';title.style.fontWeight='700';title.textContent=item.pwd;
          const meta=document.createElement('div');meta.className='meta';meta.textContent=item.meta;
          left.appendChild(title);left.appendChild(meta);
          const right=document.createElement('div');right.style.display='flex';right.style.gap='8px';
          const btnCopy=document.createElement('button');btnCopy.className='btn';btnCopy.textContent='Copy';btnCopy.addEventListener('click',()=>copyToClipboard(item.pwd));
          const btnUse=document.createElement('button');btnUse.className='btn secondary';btnUse.textContent='Use';btnUse.addEventListener('click',()=>{ if(result) result.textContent=item.pwd; updateStrength(item.pwd); renderSuggestionMeta(item.pwd, result) });
          right.appendChild(btnCopy);right.appendChild(btnUse);
          wrap.appendChild(left);wrap.appendChild(right);suggestionsEl.appendChild(wrap);
        });
      }

      // Attach meta info to the correct result panel.
      // If 'hostEl' is provided, attach to hostEl.parentElement; otherwise attach to main generator parent.
      function renderSuggestionMeta(pwd, hostEl){
        const ent = estimateEntropy(pwd);
        const seconds = Math.pow(2,ent/1.5)/1e9;
        const desc = humanDuration(seconds);
        const metaText = 'Entropy: '+Math.round(ent)+' bits · Estimated brute-force: '+desc;
        const hostParent = (hostEl && hostEl.parentElement) || (result && result.parentElement) || document.body;
        let box = hostParent.querySelector('.meta-inline');
        if(box){
          box.textContent = metaText;
        }else{
          const div=document.createElement('div');
          div.className='meta-inline';
          div.style.marginTop='8px';
          div.style.color='#6b7280';
          div.textContent=metaText;
          hostParent.appendChild(div);
        }
      }

      // Strength analysis
      function analyzePassword(pwd){
        let score=0;const advice=[];
        if(pwd.length>=8) score+=Math.min((pwd.length-7)*5,40); else advice.push('Use at least 8 characters');
        const hasLower = /[a-z]/.test(pwd);
        const hasUpper = /[A-Z]/.test(pwd);
        const hasNum = /[0-9]/.test(pwd);
        const hasSym = /[^A-Za-z0-9]/.test(pwd);
        const variety = [hasLower,hasUpper,hasNum,hasSym].filter(Boolean).length;
        score += variety*14;
        if(!hasUpper) advice.push('Add uppercase');
        if(!hasLower) advice.push('Add lowercase');
        if(!hasNum) advice.push('Add numbers');
        if(!hasSym) advice.push('Add symbols');
        score = Math.min(100, Math.floor(score));
        const rating = score<35? 'Poor' : score<65? 'Okay' : score<85? 'Good' : 'Excellent';
        const tag = score<35? 'Weak' : score<65? 'Fair' : score<85? 'Strong' : 'Unbreakable';
        return {score, rating, advice, tag};
      }
      function updateStrength(pwd){ 
        if(!strengthBar || !strengthText) return;
        if(!pwd){ strengthBar.style.width='0%'; strengthText.textContent='No password'; return }
        const a = analyzePassword(pwd);
        strengthBar.style.width = Math.min(100,a.score)+'%';
        strengthText.textContent = a.tag+' · '+a.rating;
      }

      function estimateEntropy(pwd){ let pool=0; if(/[a-z]/.test(pwd)) pool+=26; if(/[A-Z]/.test(pwd)) pool+=26; if(/[0-9]/.test(pwd)) pool+=10; if(/[^A-Za-z0-9]/.test(pwd)) pool+=32; if(pool===0) pool=1; return Math.log2(Math.pow(pool, Math.max(1,pwd.length))) }
      function humanDuration(sec){ if(!isFinite(sec)||sec>3.154e16) return 'More than 1 billion years'; const years = sec/(60*60*24*365); if(years<0.001) return Math.round(sec*1000)/1000+' seconds'; if(years<1) return Math.round(years*365)+' days'; if(years<1000) return Math.round(years)+' years'; if(years<1e6) return Math.round(years/1000)+' thousand years'; return Math.round(years/1e6)+' million years' }

      // Username generator
      if(genUser){
        genUser.addEventListener('click', ()=>{ const style = document.getElementById('unameStyle').value; const arr = generateUsernames(style,8); renderUserList(arr); });
      }
      function generateUsernames(style,count){
        const cool=['Nova','Echo','Apex','Vortex','Neon','Zenith','Orion','Halo','Kairo','Luma'];
        const gamer=['xX','_99','Pro','Killer','_YT','HD','X','Skull','_OP','OG'];
        const pro=['Tech','Dev','Hub','Labs','Works','Studio','Edge','Core','Prime','Net'];
        const out=[];for(let i=0;i<count;i++){ if(style==='cool') out.push(pick(cool)+randomDigits(2)); else if(style==='gamer') out.push(pick(cool)+pick(gamer)+randomDigits(2)); else if(style==='pro') out.push(pick(pro)+randomDigits(3)); else out.push(pick(cool)+pick(pro)+randomDigits(2)); } return out;
      }
      function renderUserList(arr){ if(!userList) return; userList.innerHTML=''; arr.forEach(u=>{ const item=document.createElement('div'); item.className='saved-item'; const l=document.createElement('div'); l.style.display='flex'; l.style.gap='12px'; l.style.alignItems='center'; const badge=document.createElement('div'); badge.className='badge'; badge.textContent='@'; const text=document.createElement('div'); text.textContent=u; l.appendChild(badge); l.appendChild(text); const r=document.createElement('div'); const c=document.createElement('button'); c.className='btn secondary'; c.textContent='Copy'; c.addEventListener('click',()=>copyToClipboard(u)); r.appendChild(c); item.appendChild(l); item.appendChild(r); userList.appendChild(item); }); }

      // Saved passwords (local)
      function getSaved(){ try{ return JSON.parse(localStorage.getItem('sg_saved')||'[]') }catch(e){ return [] } }
      function savePassword(label,pwd){ if(!pwd) return alert('No password to save'); const arr = getSaved(); arr.unshift({id:Date.now(),label,pwd}); localStorage.setItem('sg_saved', JSON.stringify(arr)); alert('Saved locally') }
      function mask(s){ return '•'.repeat(Math.min(12, (s||'').length)) }
      function renderSaved(){ const arr=getSaved(); const el=document.getElementById('savedList'); if(!el) return; el.innerHTML=''; if(arr.length===0){ el.textContent='No saved passwords yet.'; return } arr.forEach(it=>{ const item=document.createElement('div'); item.className='saved-item'; const left=document.createElement('div'); left.style.display='flex'; left.style.gap='12px'; left.style.alignItems='center'; const badge=document.createElement('div'); badge.className='badge'; badge.textContent = it.label? it.label[0] : '#'; const info=document.createElement('div'); info.style.minWidth='160px'; info.style.overflow='hidden'; info.style.textOverflow='ellipsis'; const strong=document.createElement('strong'); strong.textContent = it.label; const tiny=document.createElement('div'); tiny.style.color='#6b7280'; tiny.style.fontSize='13px'; tiny.textContent = mask(it.pwd); info.appendChild(strong); info.appendChild(tiny); left.appendChild(badge); left.appendChild(info); const right=document.createElement('div'); right.style.display='flex'; right.style.gap='8px'; const btnReveal=document.createElement('button'); btnReveal.className='btn'; btnReveal.textContent='Reveal'; btnReveal.addEventListener('click', ()=>{ alert('Label: '+it.label+'\nPassword: '+it.pwd); }); const btnCopy=document.createElement('button'); btnCopy.className='btn secondary'; btnCopy.textContent='Copy'; btnCopy.addEventListener('click', ()=>copyToClipboard(it.pwd)); const btnDel=document.createElement('button'); btnDel.className='btn secondary'; btnDel.textContent='Delete'; btnDel.addEventListener('click', ()=>{ if(!confirm('Delete this saved password?')) return; const remaining=getSaved().filter(x=>x.id!==it.id); localStorage.setItem('sg_saved', JSON.stringify(remaining)); renderSaved(); }); right.appendChild(btnReveal); right.appendChild(btnCopy); right.appendChild(btnDel); item.appendChild(left); item.appendChild(right); el.appendChild(item); }); }
      document.getElementById('exportBtn')?.addEventListener('click', ()=>{ const data = localStorage.getItem('sg_saved')||'[]'; copyToClipboard(data); alert('Saved JSON copied to clipboard') });
      document.getElementById('clearAll')?.addEventListener('click', ()=>{ if(confirm('Clear all saved passwords?')){ localStorage.removeItem('sg_saved'); renderSaved() } });

      // Strength checker
      checkBtn?.addEventListener('click', ()=>{ const pwd = (checkInput.value||'').trim(); if(!pwd) return alert('Please enter a password to check'); const analysis = analyzePassword(pwd); const ent = Math.round(estimateEntropy(pwd)); const sec = Math.pow(2,ent/1.5)/1e9; checkResult.innerHTML = '<strong>Score:</strong> '+analysis.score+'/100 — <em>'+analysis.rating+'</em><br/><strong>Entropy:</strong> '+ent+' bits · <strong>Est. brute-force:</strong> '+humanDuration(sec)+'<br/><strong>Advice:</strong> '+(analysis.advice.length?analysis.advice.join(', '):'None'); });
      document.getElementById('clearCheck')?.addEventListener('click', ()=>{ if(checkInput) checkInput.value=''; if(checkResult) checkResult.textContent='No password checked yet.' });

      // other bindings
      document.getElementById('jump-generator')?.addEventListener('click', ()=>{ location.hash='tools'; document.getElementById('generator')?.scrollIntoView({behavior:'smooth',block:'start'}) });
      document.getElementById('try-tools')?.addEventListener('click', ()=>{ location.hash='tools'; document.getElementById('tools')?.scrollIntoView({behavior:'smooth',block:'start'}) });
      document.getElementById('sendMsg')?.addEventListener('click', ()=>{ alert('This demo does not actually send messages. Configure a serverless endpoint to handle submissions.') });
      document.addEventListener('keydown', e=>{ if(e.ctrlKey&&e.key==='g'){ e.preventDefault(); document.getElementById('generator')?.scrollIntoView({behavior:'smooth',block:'start'}) } });

      // init
      renderSaved();

      // --- Basic tests for critical functions (console + hidden output) ---
      const tests = [];
      try{
        tests.push({name:'entropy small', val: estimateEntropy('a')>0});
        tests.push({name:'entropy mixed', val: estimateEntropy('Aa1!')>estimateEntropy('a')});
        tests.push({name:'analyze short', val: analyzePassword('abc').score<30});
        tests.push({name:'analyze strong', val: analyzePassword('Aq1!zY9@3r').score>60});
        tests.push({name:'generate length', val: generatePassword(12,{upper:true,lower:true,numbers:true,symbols:true}).length===12});
      }catch(e){ tests.push({name:'tests crashed', val:false,err:e.message}) }
      const testOut = document.getElementById('testOutput');
      if(testOut) testOut.style.display='none';
      console.group('SecureGen Tests');
      tests.forEach(t=>{ console.log(t.name, t.val ? 'PASS' : 'FAIL', t.err? t.err : ''); });
      console.groupEnd();

    }); // end DOMContentLoaded
  </script>
</body>
</html>
